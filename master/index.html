<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>CellBase.jl · CellBase</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>CellBase</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>CellBase.jl</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#What-is-package-does"><span>What is package does</span></a></li><li class="toplevel"><a class="tocitem" href="#Guides"><span>Guides</span></a></li><li><a class="tocitem" href="#Lattice-type"><span><code>Lattice</code> type</span></a></li><li><a class="tocitem" href="#Cell-type"><span><code>Cell</code> type</span></a></li><li><a class="tocitem" href="#[Spglib.jl](https://github.com/singularitti/Spglib.jl)-interface"><span>Spglib.jl interface</span></a></li><li><a class="tocitem" href="#Misc-utils"><span>Misc utils</span></a></li><li><a class="tocitem" href="#Neighbour-lists"><span>Neighbour lists</span></a></li><li><a class="tocitem" href="#IO"><span>IO</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>CellBase.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>CellBase.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/zhubonan/CellBase/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="CellBase.jl"><a class="docs-heading-anchor" href="#CellBase.jl">CellBase.jl</a><a id="CellBase.jl-1"></a><a class="docs-heading-anchor-permalink" href="#CellBase.jl" title="Permalink"></a></h1><p>Documentation for CellBase.jl</p><h1 id="What-is-package-does"><a class="docs-heading-anchor" href="#What-is-package-does">What is package does</a><a id="What-is-package-does-1"></a><a class="docs-heading-anchor-permalink" href="#What-is-package-does" title="Permalink"></a></h1><p>Provide a basic low level interface for storing and handling crystal structure data.  The target application is for small and periodic cells, with the emphasis on both ease to use as well as performance.</p><h1 id="Guides"><a class="docs-heading-anchor" href="#Guides">Guides</a><a id="Guides-1"></a><a class="docs-heading-anchor-permalink" href="#Guides" title="Permalink"></a></h1><h2 id="Lattice-type"><a class="docs-heading-anchor" href="#Lattice-type"><code>Lattice</code> type</a><a id="Lattice-type-1"></a><a class="docs-heading-anchor-permalink" href="#Lattice-type" title="Permalink"></a></h2><p>The <code>Lattice</code> type represents the lattice. The lattice vectors are stored as a matrix of <strong>column vectors</strong>.  For example, the first lattice vector should be accessed as <code>cellmat(lattice)[:, 1]</code>.</p><div class="admonition is-info"><header class="admonition-header">Updating an existing `Lattice`</header><div class="admonition-body"><p>The reciprocal lattice is also stored for quick access, however, this means that whenever the matrix is directly modified, the store reciprocal lattice vectors should be updated as well. Hence, the <code>set_cellmat!</code> function should be used for updating the cell matrix, which does this is automatically.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="CellBase.Lattice" href="#CellBase.Lattice"><code>CellBase.Lattice</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Lattice{T}</p><p>The type represents a lattice in 3D space formed by three column lattice vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L4-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.Lattice-Union{Tuple{Matrix{T}}, Tuple{T}} where T" href="#CellBase.Lattice-Union{Tuple{Matrix{T}}, Tuple{T}} where T"><code>CellBase.Lattice</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Lattice(matrix::Matrix{T}) where T</code></pre><p>Construct a <code>Lattice</code> from a matrix of column vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.Lattice-Union{Tuple{T}, NTuple{6, T}} where T" href="#CellBase.Lattice-Union{Tuple{T}, NTuple{6, T}} where T"><code>CellBase.Lattice</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Lattice(a::T, b::T, c::T, α::T, β::T, γ::T) where T</code></pre><p>Construct a <code>Lattice</code> from lattice parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L47-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.Lattice-Union{Tuple{T}, Tuple{T, T, T}} where T&lt;:Real" href="#CellBase.Lattice-Union{Tuple{T}, Tuple{T, T, T}} where T&lt;:Real"><code>CellBase.Lattice</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Lattice(a::T, b::T, c::T) where T &lt;: Real</code></pre><p>Construct a <code>Lattice</code> with orthogonal lattice vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.Lattice-Union{Tuple{T}, Tuple{Vector{T}, Vector{T}, Vector{T}}} where T" href="#CellBase.Lattice-Union{Tuple{T}, Tuple{Vector{T}, Vector{T}, Vector{T}}} where T"><code>CellBase.Lattice</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Lattice(va::Vector{T}, vb::Vector{T}, vc::Vector{T}) where T</code></pre><p>Construct a <code>Lattice</code> from three lattice vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L27-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.Lattice-Union{Tuple{Vector{T}}, Tuple{T}} where T" href="#CellBase.Lattice-Union{Tuple{Vector{T}}, Tuple{T}} where T"><code>CellBase.Lattice</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Lattice(cellpar::Vector{T}) where T</code></pre><p>Construct a <code>Lattice</code> from a six-vector of lattice parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.cellmat-Tuple{Lattice}" href="#CellBase.cellmat-Tuple{Lattice}"><code>CellBase.cellmat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cellmat(lattice::Lattice)</code></pre><p>Return the matrix of column vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L91-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.cellmat_row-Tuple{Lattice}" href="#CellBase.cellmat_row-Tuple{Lattice}"><code>CellBase.cellmat_row</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Get a matrix of column vectors</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L114">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.cellpar-Tuple{Lattice}" href="#CellBase.cellpar-Tuple{Lattice}"><code>CellBase.cellpar</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cellpar(lattice::Lattice)</code></pre><p>Return the lattice parameters as a six-vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L126-L130">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.cellvecs-Tuple{Lattice}" href="#CellBase.cellvecs-Tuple{Lattice}"><code>CellBase.cellvecs</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Lattice vectors</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L117">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.frac_pos-Tuple{Site, Lattice}" href="#CellBase.frac_pos-Tuple{Site, Lattice}"><code>CellBase.frac_pos</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Fraction positions of a site</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.get_cellmat-Tuple{Lattice}" href="#CellBase.get_cellmat-Tuple{Lattice}"><code>CellBase.get_cellmat</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Return a copy of the cell matrix</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L108">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.get_rec_cellmat-Tuple{Lattice}" href="#CellBase.get_rec_cellmat-Tuple{Lattice}"><code>CellBase.get_rec_cellmat</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Return a copy of the reciprocal cell matrix</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L111">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.get_scaled_positions-Tuple{Lattice, AbstractVecOrMat{T} where T}" href="#CellBase.get_scaled_positions-Tuple{Lattice, AbstractVecOrMat{T} where T}"><code>CellBase.get_scaled_positions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_scaled_positions(l::Lattice, v::AbstractVecOrMat) = reciprocal(l) * v</code></pre><p>Return the scaled positions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L174-L178">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.mic-Tuple{Lattice, AbstractVecOrMat{T} where T}" href="#CellBase.mic-Tuple{Lattice, AbstractVecOrMat{T} where T}"><code>CellBase.mic</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mic(l::Lattice, vec::AbstractVecOrMat)</code></pre><p>Compute the minimum-image convention representation of a series of displacement vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L289-L293">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.mic_naive-Tuple{Lattice, AbstractMatrix{T} where T}" href="#CellBase.mic_naive-Tuple{Lattice, AbstractMatrix{T} where T}"><code>CellBase.mic_naive</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Compute naive MIC representation of the vector(s)</p><p>Not safe for skewed cells. Requires</p><pre><code class="language-julia hljs">norm(length) &lt; 0.5 * min(cellpar(l)[1:3])</code></pre><p>See also:</p><ul><li>W. Smith, &quot;The Minimum Image Convention in Non-Cubic MD Cells&quot;, 1989,   http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.57.1696.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L196-L209">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.mic_naive-Tuple{Lattice, AbstractVector{T} where T}" href="#CellBase.mic_naive-Tuple{Lattice, AbstractVector{T} where T}"><code>CellBase.mic_naive</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs"> mic_safe(l::Lattice, v::AbstractVector)</code></pre><p>Compute MIC representation of vectors using a safe approach based on Minkowski reduced cell</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L219-L223">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.mic_safe-Tuple{Lattice, AbstractMatrix{T} where T}" href="#CellBase.mic_safe-Tuple{Lattice, AbstractMatrix{T} where T}"><code>CellBase.mic_safe</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs"> mic_safe(l::Lattice, v::AbstractMatrix)</code></pre><p>Compute MIC representation of vectors using a safe approach based on Minkowski reduced cell</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L227-L231">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.mic_safe-Tuple{Lattice, AbstractVector{T} where T}" href="#CellBase.mic_safe-Tuple{Lattice, AbstractVector{T} where T}"><code>CellBase.mic_safe</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs"> mic_safe(l::Lattice, v::AbstractVector)</code></pre><p>Compute MIC representation of vectors using a safe approach based on Minkowski reduced cell</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L270-L274">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.random_vec-Tuple{Lattice}" href="#CellBase.random_vec-Tuple{Lattice}"><code>CellBase.random_vec</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Random displacement vector in a unit cell</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L169">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.random_vec_in_cell-Union{Tuple{Matrix{T}}, Tuple{T}} where T" href="#CellBase.random_vec_in_cell-Union{Tuple{Matrix{T}}, Tuple{T}} where T"><code>CellBase.random_vec_in_cell</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">random_vec_in_cell(cell::Matrix{T}; scales::Vector=ones(size(cell)[1])) where T</code></pre><p>Get an random vector within a unit cell. The cell is a matrix made of column vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L156-L160">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.rec_cellmat-Tuple{Lattice}" href="#CellBase.rec_cellmat-Tuple{Lattice}"><code>CellBase.rec_cellmat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rec_cellmat(l::Lattice)</code></pre><p>Returns the matrix of reciprocal lattice vectors (without the <span>$2\pi$</span> factor).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L77-L81">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.reciprocal-Tuple{Lattice}" href="#CellBase.reciprocal-Tuple{Lattice}"><code>CellBase.reciprocal</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">reciprocal(l::Lattice)</code></pre><p>Returns the matrix of reciprocal lattice vectors (without the <span>$2\pi$</span> factor).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L70-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.scaled_positions" href="#CellBase.scaled_positions"><code>CellBase.scaled_positions</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Alias  to <code>get_scaled_positions</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L181">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.set_cellmat!-Tuple{Lattice, Any}" href="#CellBase.set_cellmat!-Tuple{Lattice, Any}"><code>CellBase.set_cellmat!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_cellmat!(lattice::Lattice, mat)</code></pre><p>Set the cell matrix and update the reciprocal cell matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L98-L102">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.update_rec!-Tuple{Lattice}" href="#CellBase.update_rec!-Tuple{Lattice}"><code>CellBase.update_rec!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update_rec!(l::Lattice)</code></pre><p>Update the reciprocal matrix - <em>this should be called everytime cell is changed.</em></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L84-L88">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.volume-Tuple{Lattice}" href="#CellBase.volume-Tuple{Lattice}"><code>CellBase.volume</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Return the volume of the cell</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L120">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.wrap!-Tuple{Site, Lattice}" href="#CellBase.wrap!-Tuple{Site, Lattice}"><code>CellBase.wrap!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Wrap a site back into the box</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L136">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.wrap_positions-Tuple{Lattice, AbstractVecOrMat{T} where T}" href="#CellBase.wrap_positions-Tuple{Lattice, AbstractVecOrMat{T} where T}"><code>CellBase.wrap_positions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wrap_positions(l::Lattice, v::AbstractVecOrMat)</code></pre><p>Wrap positions back into the box defined by the cell vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/lattice.jl#L184-L188">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.max_shifts-Tuple{AbstractArray, Real}" href="#CellBase.max_shifts-Tuple{AbstractArray, Real}"><code>CellBase.max_shifts</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Compute the require periodicities required to fill a cut off sphere of a certain radius</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/periodic.jl#L58-L60">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.shift_indices-Tuple{AbstractArray, Real}" href="#CellBase.shift_indices-Tuple{AbstractArray, Real}"><code>CellBase.shift_indices</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">shift_indices(lattice::AbstractArray, rc::Real)</code></pre><p>Compute a vector containing shift indices</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/periodic.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.shift_vectors" href="#CellBase.shift_vectors"><code>CellBase.shift_vectors</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">shift_vectors(lattice::AbstractMatrix, shift1, shift2, shift3)</code></pre><p>Compute the shift vectors needed to include all parts of the lattice within a cut off radius.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/periodic.jl#L7-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.shift_vectors-Tuple{AbstractMatrix{T} where T, Real}" href="#CellBase.shift_vectors-Tuple{AbstractMatrix{T} where T, Real}"><code>CellBase.shift_vectors</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Compute shift vectors given lattice matrix and cut off radius</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/periodic.jl#L31">source</a></section></article><h2 id="Cell-type"><a class="docs-heading-anchor" href="#Cell-type"><code>Cell</code> type</a><a id="Cell-type-1"></a><a class="docs-heading-anchor-permalink" href="#Cell-type" title="Permalink"></a></h2><p>The <code>Cell</code> type represent a crystal structure combining the positions of atoms and the lattice vectors. It basically combines the <code>Lattice</code>, the atomic positions and their identities. Internally, the formere is stored as an matrix of column vectors of the absolute positions (cartesian space).</p><p>For flexibility, any additional array like data can be stored in the <code>arrays</code> property which is a dictionary with <code>Symbol</code> keys. Additional metadata can be also be stored under <code>metadata</code>, which is a <code>Dict{Any, Any}</code>. </p><article class="docstring"><header><a class="docstring-binding" id="CellBase.Cell" href="#CellBase.Cell"><code>CellBase.Cell</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A Cell represents a periodic structure in three-dimensional space.</p><p>Defined as:</p><pre><code class="language-julia hljs">mutable struct Cell{T}
    lattice::Lattice{T}                 # Lattice of the structure
    symbols::Vector{Symbol}
    positions::Matrix{T}
    arrays::Dict{Symbol, AbstractArray}        # Any additional arrays
    metadata::Dict
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L8-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.Cell-Tuple{Lattice, Any, Vector{T} where T}" href="#CellBase.Cell-Tuple{Lattice, Any, Vector{T} where T}"><code>CellBase.Cell</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Cell(lat::Lattice, numbers::Vector{Int}, positions::Vector)</code></pre><p>Constructure the Cell type from lattice, positions and numbers</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L54-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.Cell-Tuple{Lattice, Vector{Symbol}, Matrix{T} where T}" href="#CellBase.Cell-Tuple{Lattice, Vector{Symbol}, Matrix{T} where T}"><code>CellBase.Cell</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Cell(l::Lattice, symbols, positions) where T</code></pre><p>Construct a Cell type from arrays</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L31-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.Cell-Union{Tuple{T}, Tuple{Lattice, Vector{T}, Matrix{T} where T}} where T&lt;:Real" href="#CellBase.Cell-Union{Tuple{T}, Tuple{Lattice, Vector{T}, Matrix{T} where T}} where T&lt;:Real"><code>CellBase.Cell</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Cell(lat::Lattice, numbers::Vector{Int}, positions)</code></pre><p>Constructure the Cell type from lattice, positions and numbers</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L42-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.array-Tuple{Cell, Symbol}" href="#CellBase.array-Tuple{Cell, Symbol}"><code>CellBase.array</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">array(structure::Cell, arrayname::Symbol)</code></pre><p>Return the additional array stored in the <code>Cell</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L193-L197">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.arraynames-Tuple{Cell}" href="#CellBase.arraynames-Tuple{Cell}"><code>CellBase.arraynames</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">arraynames(structure::Cell)</code></pre><p>Return the names of additional arrays.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L200-L204">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.atomic_numbers-Tuple{Cell}" href="#CellBase.atomic_numbers-Tuple{Cell}"><code>CellBase.atomic_numbers</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">atomic_numbers(structure::Cell)</code></pre><p>Return a Vector of the atomic numbers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L139-L143">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.attachmetadata!-Tuple{Cell, Dict}" href="#CellBase.attachmetadata!-Tuple{Cell, Dict}"><code>CellBase.attachmetadata!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">attachmetadata!(structure::Cell, metadata::Dict)</code></pre><p>Replace <code>metadata</code> with an existing dictionary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L214-L218">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.cellmat-Tuple{Cell}" href="#CellBase.cellmat-Tuple{Cell}"><code>CellBase.cellmat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cellmat(structure::Cell)</code></pre><p>Return the matrix of lattice vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L176-L180">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.cellpar-Tuple{Cell}" href="#CellBase.cellpar-Tuple{Cell}"><code>CellBase.cellpar</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cellpar(structure::Cell)</code></pre><p>Return the lattice parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L162-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.check_minsep-Union{Tuple{T}, Tuple{Cell, Dict{T, Float64}}} where T" href="#CellBase.check_minsep-Union{Tuple{T}, Tuple{Cell, Dict{T, Float64}}} where T"><code>CellBase.check_minsep</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_minsep(structure::Cell, minsep::Dict)</code></pre><p>Check if the minimum separation constraints are satisfied. Minimum separations are supplied as an dictionary where the global version under the :global key. To supply the minimum separations between A and B, pass Dict((:A=&gt;:B)=&gt;1.0). Return true or false.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L436-L443">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.clip-Tuple{Cell, AbstractVector{T} where T}" href="#CellBase.clip-Tuple{Cell, AbstractVector{T} where T}"><code>CellBase.clip</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">clip(s::Cell, mask::AbstractVector)</code></pre><p>Clip a structure with a given indexing array</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L69-L73">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.compute_minsep_mat-Union{Tuple{T}, Tuple{Any, Dict{T, Float64}}} where T" href="#CellBase.compute_minsep_mat-Union{Tuple{T}, Tuple{Any, Dict{T, Float64}}} where T"><code>CellBase.compute_minsep_mat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">minsep_matrix(structure::Cell, minsep::Dict)</code></pre><p>Initialise the minimum separation matrix and species mapping. Returns the unique species, integer indexed species and the minimum separation matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L461-L466">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.distance_matrix-Tuple{Cell}" href="#CellBase.distance_matrix-Tuple{Cell}"><code>CellBase.distance_matrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">distance_matrix(structure::Cell; mic=true)</code></pre><p>Compute the distance matrix for the given structure, using the minimum image convention (or not).</p><p>Note the returned matrix does not expand the cell. The distance matrix cannot be safety used for obtaining the minimum separations. For example, a structure with a single atom would be a distance matrix containing only zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L384-L392">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.distance_squared_between-Tuple{Matrix{T} where T, Any, Any, Matrix{T} where T, Any}" href="#CellBase.distance_squared_between-Tuple{Matrix{T} where T, Any, Any, Matrix{T} where T, Any}"><code>CellBase.distance_squared_between</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">distance_squared_between(posmat::Matrix, i, j, svec::Matrix, ishift)</code></pre><p>Return the squared distance between two positions stored in a matrix and shift vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L421-L425">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.fingerprint-Tuple{Cell}" href="#CellBase.fingerprint-Tuple{Cell}"><code>CellBase.fingerprint</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fingerprint(s::Cell; dmat=distance_matrix(s), weighted=true, cut_bl=3.0)</code></pre><p>Computed the fingerprint vector based on simple sorted pair-wise distances. NOTE: Does not work for single atom cell!!</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L528-L533">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.fingerprint_distance-Tuple{AbstractVector{T} where T, AbstractVector{T} where T}" href="#CellBase.fingerprint_distance-Tuple{AbstractVector{T} where T, AbstractVector{T} where T}"><code>CellBase.fingerprint_distance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fingerprint_distance(f1::AbstractVector, f2::AbstractVector;lim=Inf)</code></pre><p>Compute the deviation between two finger print vectors</p><p>Comparison is truncated by the size of the shortest vector of the two, or by the <code>lim</code> key word.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L570-L577">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.formula_and_factor-Tuple{Cell}" href="#CellBase.formula_and_factor-Tuple{Cell}"><code>CellBase.formula_and_factor</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">formula_and_factor(structure::Cell)</code></pre><p>Return reduced formula and associated factor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L246-L250">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.get_cellmat-Tuple{Cell}" href="#CellBase.get_cellmat-Tuple{Cell}"><code>CellBase.get_cellmat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_cellmat(structure::Cell)</code></pre><p>Return the matrix of lattice vectors(copy).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L183-L187">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.get_lattice-Tuple{Cell}" href="#CellBase.get_lattice-Tuple{Cell}"><code>CellBase.get_lattice</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_lattice(structure::Cell)</code></pre><p>Return the <code>Lattice</code> instance (copy).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L155-L159">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.get_positions-Tuple{Cell}" href="#CellBase.get_positions-Tuple{Cell}"><code>CellBase.get_positions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_positions(cell::Cell)</code></pre><p>Return a <em>copy</em> of the positions (cartesian coordinates) of the atoms in a structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L110-L114">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.get_scaled_positions-Tuple{Cell}" href="#CellBase.get_scaled_positions-Tuple{Cell}"><code>CellBase.get_scaled_positions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_fraction_positions(cell::Cell)</code></pre><p>Return fractional positions of the cell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L296-L300">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.get_species-Tuple{Cell}" href="#CellBase.get_species-Tuple{Cell}"><code>CellBase.get_species</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_species(structure::Cell)</code></pre><p>Return a Vector (copy) of species names.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L132-L136">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.lattice-Tuple{Cell}" href="#CellBase.lattice-Tuple{Cell}"><code>CellBase.lattice</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">lattice(structure::Cell)</code></pre><p>Return the <code>Lattice</code> instance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L148-L152">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.make_supercell-Tuple{Cell, Any, Any, Any}" href="#CellBase.make_supercell-Tuple{Cell, Any, Any, Any}"><code>CellBase.make_supercell</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">make_supercell(structure::Cell, a, b, c)</code></pre><p>Make a supercell</p><p>Currently only work with diagonal transform matrices. TODO: Write function for the general cases....</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L490-L497">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.metadata-Tuple{Cell}" href="#CellBase.metadata-Tuple{Cell}"><code>CellBase.metadata</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">metadata(structure::Cell)</code></pre><p>Return the <code>metadata</code> dictionary. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L207-L211">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.natoms" href="#CellBase.natoms"><code>CellBase.natoms</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">natoms(cell::Cell)</code></pre><p>Return number of atoms in a structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L95-L99">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.nions-Tuple{Cell}" href="#CellBase.nions-Tuple{Cell}"><code>CellBase.nions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">nions(cell::Cell)</code></pre><p>Return number of atoms in a structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L87-L91">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.num_fu-Tuple{Cell}" href="#CellBase.num_fu-Tuple{Cell}"><code>CellBase.num_fu</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">num_fu(structure::Cell)</code></pre><p>Return the number of formula units.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L221-L225">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.positions-Tuple{Cell}" href="#CellBase.positions-Tuple{Cell}"><code>CellBase.positions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">positions(cell::Cell)</code></pre><p>Return positions (cartesian coordinates) of the atoms in a structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L102-L106">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.rattle!-Tuple{Cell, Any}" href="#CellBase.rattle!-Tuple{Cell, Any}"><code>CellBase.rattle!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rattle!(cell::Cell, amp)</code></pre><p>Rattle the positions of the cell for a given maximum amplitude (uniform distribution).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L349-L353">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.reduced_fu-Tuple{Cell}" href="#CellBase.reduced_fu-Tuple{Cell}"><code>CellBase.reduced_fu</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">reduced_fu(structure::Cell)</code></pre><p>Return the reduced formula.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L228-L232">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.set_cellmat!-Tuple{Cell, Any}" href="#CellBase.set_cellmat!-Tuple{Cell, Any}"><code>CellBase.set_cellmat!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_cellmat!(cell::Cell, mat;scale_positions=true)</code></pre><p>Update the <code>Lattice</code> with a new matrix of lattice vectors.  Scale of the existing postions if needed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L325-L330">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.set_positions!-Tuple{Cell, Any}" href="#CellBase.set_positions!-Tuple{Cell, Any}"><code>CellBase.set_positions!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_positions!(cell::Cell, pos)</code></pre><p>Set the positions of the <code>Cell</code> with a new matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L342-L346">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.set_scaled_positions!-Tuple{Cell, Matrix{T} where T}" href="#CellBase.set_scaled_positions!-Tuple{Cell, Matrix{T} where T}"><code>CellBase.set_scaled_positions!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_scaled_positions!(cell::Cell, scaled::Matrix)</code></pre><p>Set scaled positions for a cell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L305-L309">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.sorted_symbols-Tuple{Any}" href="#CellBase.sorted_symbols-Tuple{Any}"><code>CellBase.sorted_symbols</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">sorted_symbols(symbols)</code></pre><p>Return sorted symbols by atomic numbers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L235-L239">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.species-Tuple{Cell}" href="#CellBase.species-Tuple{Cell}"><code>CellBase.species</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">species(structure::Cell)</code></pre><p>Return a Vector of species names.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L125-L129">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.specindex-Tuple{Any}" href="#CellBase.specindex-Tuple{Any}"><code>CellBase.specindex</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">specindex(structure::Cell)</code></pre><p>Return the unique species and integer based indices for each atom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L284-L288">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.sposarray-Union{Tuple{Cell{T}}, Tuple{T}} where T" href="#CellBase.sposarray-Union{Tuple{Cell{T}}, Tuple{T}} where T"><code>CellBase.sposarray</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">sposarray(cell::Cell)</code></pre><p>Return the positions as a Vector of static arrays. The returned array can provide improved performance for certain type of operations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L117-L122">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.volume-Tuple{Cell}" href="#CellBase.volume-Tuple{Cell}"><code>CellBase.volume</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">volume(structure::Cell)</code></pre><p>Return the volume of the cell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L169-L173">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.wrap!-Tuple{Cell}" href="#CellBase.wrap!-Tuple{Cell}"><code>CellBase.wrap!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wrap!(cell::Cell)</code></pre><p>Wrap atom outside of the lattice back into the box defined by the lattice vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/cell.jl#L314-L318">source</a></section></article><h2 id="[Spglib.jl](https://github.com/singularitti/Spglib.jl)-interface"><a class="docs-heading-anchor" href="#[Spglib.jl](https://github.com/singularitti/Spglib.jl)-interface"><a href="https://github.com/singularitti/Spglib.jl">Spglib.jl</a> interface</a><a id="[Spglib.jl](https://github.com/singularitti/Spglib.jl)-interface-1"></a><a class="docs-heading-anchor-permalink" href="#[Spglib.jl](https://github.com/singularitti/Spglib.jl)-interface" title="Permalink"></a></h2><p>The routine in <code>Spglib.jl</code> (which wraps the <a href="https://spglib.github.io/spglib/">spglib</a> libraray) can be used for finding symmetry and performing reduction of the <code>Cell</code> type.</p><article class="docstring"><header><a class="docstring-binding" id="CellBase.Cell-Tuple{Spglib.Cell}" href="#CellBase.Cell-Tuple{Spglib.Cell}"><code>CellBase.Cell</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Cell(cell::SCell)</code></pre><p>Return a <code>Cell</code> object from <code>Spglib.Cell</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/spg.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.SCell" href="#CellBase.SCell"><code>CellBase.SCell</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Alias for <code>Spglib.Cell</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/spg.jl#L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.SCell-Tuple{Cell}" href="#CellBase.SCell-Tuple{Cell}"><code>CellBase.SCell</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SCell(cell::Cell)</code></pre><p>Construct <code>Spglib.Cell</code> from <code>Cell</code> type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/spg.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.@extend_scell-Tuple{Any}" href="#CellBase.@extend_scell-Tuple{Any}"><code>CellBase.@extend_scell</code></a> — <span class="docstring-category">Macro</span></header><section><div><p>Macro for extending the Spglib methods.</p><p>Usage:</p><pre><code class="nohighlight hljs">@extend_scell get_dataset</code></pre><p>will allow the <code>get_dataset</code> method of Spglib to be used for <code>Cell</code> type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/spg.jl#L37-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.@extend_scell_roundtrip-Tuple{Any}" href="#CellBase.@extend_scell_roundtrip-Tuple{Any}"><code>CellBase.@extend_scell_roundtrip</code></a> — <span class="docstring-category">Macro</span></header><section><div><p>Macro for extending the Spglib methods and convert returned <code>Spglib.Cell</code> to <code>Cell</code>.</p><p>Usage:</p><pre><code class="nohighlight hljs">@extend_scell_roundtrip standardize_cell</code></pre><p>will allow the <code>standardize_cell</code> method to be used and the returned <code>Spglib.Cell</code> is converted to <code>Cell</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/spg.jl#L54-L64">source</a></section></article><h2 id="Misc-utils"><a class="docs-heading-anchor" href="#Misc-utils">Misc utils</a><a id="Misc-utils-1"></a><a class="docs-heading-anchor-permalink" href="#Misc-utils" title="Permalink"></a></h2><p>Miscellaneous utility functions.</p><article class="docstring"><header><a class="docstring-binding" id="CellBase.reduction_gauss-Tuple{Matrix{T} where T, Vector{T} where T, Vector{T} where T}" href="#CellBase.reduction_gauss-Tuple{Matrix{T} where T, Vector{T} where T, Vector{T} where T}"><code>CellBase.reduction_gauss</code></a> — <span class="docstring-category">Method</span></header><section><div><p>2D Gauss reduction</p><p>Works for column vectors instead of row vectors</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/minkowski.jl#L50-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.cellpar2mat-NTuple{6, Any}" href="#CellBase.cellpar2mat-NTuple{6, Any}"><code>CellBase.cellpar2mat</code></a> — <span class="docstring-category">Method</span></header><section><div><p>convert cell parameters to column vectors</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/mathutils.jl#L90">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.isvalidcellpar-NTuple{6, Any}" href="#CellBase.isvalidcellpar-NTuple{6, Any}"><code>CellBase.isvalidcellpar</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Check if cell parameters are valid</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/mathutils.jl#L77">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.vec2cellpar-Tuple{AbstractVector{T} where T, AbstractVector{T} where T, AbstractVector{T} where T}" href="#CellBase.vec2cellpar-Tuple{AbstractVector{T} where T, AbstractVector{T} where T, AbstractVector{T} where T}"><code>CellBase.vec2cellpar</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Convert cell vectors to cell parameters</p><p>Returns an static array of the cell parameters</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/mathutils.jl#L22-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.volume-NTuple{6, Any}" href="#CellBase.volume-NTuple{6, Any}"><code>CellBase.volume</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Compute volume from cell parameters</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/mathutils.jl#L114">source</a></section></article><h2 id="Neighbour-lists"><a class="docs-heading-anchor" href="#Neighbour-lists">Neighbour lists</a><a id="Neighbour-lists-1"></a><a class="docs-heading-anchor-permalink" href="#Neighbour-lists" title="Permalink"></a></h2><p>Type and functions for handling neighbour lists.</p><article class="docstring"><header><a class="docstring-binding" id="CellBase.ExtendedPointArray" href="#CellBase.ExtendedPointArray"><code>CellBase.ExtendedPointArray</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Represent an array of points after expansion by periodic boundary</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L12-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.ExtendedPointArray-Tuple{Cell, Any}" href="#CellBase.ExtendedPointArray-Tuple{Cell, Any}"><code>CellBase.ExtendedPointArray</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ExtendedPointArray(cell::Cell, rcut)</code></pre><p>Constructed an ExtendedPointArray from a given structure</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.NLIterator" href="#CellBase.NLIterator"><code>CellBase.NLIterator</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Iterator interface for going through all neighbours</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L292">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.NLIteratorWithVector" href="#CellBase.NLIteratorWithVector"><code>CellBase.NLIteratorWithVector</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Iterator interface for going through all neighbours</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L298">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.NeighbourList" href="#CellBase.NeighbourList"><code>CellBase.NeighbourList</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Type for representing a neighbour list</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L113-L115">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.NeighbourList" href="#CellBase.NeighbourList"><code>CellBase.NeighbourList</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">NeighbourList(ea::ExtendedPointArray, rcut, nmax=100; savevec=false)</code></pre><p>Construct a NeighbourList from an extended point array for the points in the original cell</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L158-L162">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.eachneighbour-Tuple{NeighbourList, Any}" href="#CellBase.eachneighbour-Tuple{NeighbourList, Any}"><code>CellBase.eachneighbour</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Iterate the neighbours of a site in the original cell. Returns a tuple of (original<em>index, extended</em>index, distance) for each iteration</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L325-L328">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.eachneighbourvector-Tuple{NeighbourList, Any}" href="#CellBase.eachneighbourvector-Tuple{NeighbourList, Any}"><code>CellBase.eachneighbourvector</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Iterate the neighbours of a site in the original cell. Returns a tuple of (original<em>index, extended</em>index, distance, vector) for each iteration</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L332-L335">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.nions_extended-Tuple{ExtendedPointArray}" href="#CellBase.nions_extended-Tuple{ExtendedPointArray}"><code>CellBase.nions_extended</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Number of ions in the extended cell</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L146">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.nions_extended-Tuple{NeighbourList}" href="#CellBase.nions_extended-Tuple{NeighbourList}"><code>CellBase.nions_extended</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Number of ions in the extended cell</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L148">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.nions_orig-Tuple{ExtendedPointArray}" href="#CellBase.nions_orig-Tuple{ExtendedPointArray}"><code>CellBase.nions_orig</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Number of ions in the original cell</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L141">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.nions_orig-Tuple{NeighbourList}" href="#CellBase.nions_orig-Tuple{NeighbourList}"><code>CellBase.nions_orig</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Number of ions in the original cell</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L143">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.num_neighbours-Tuple{NeighbourList, Any}" href="#CellBase.num_neighbours-Tuple{NeighbourList, Any}"><code>CellBase.num_neighbours</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Number of neighbours for a point</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L286">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.rebuild!-Tuple{ExtendedPointArray, Any}" href="#CellBase.rebuild!-Tuple{ExtendedPointArray, Any}"><code>CellBase.rebuild!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Rebuild the ExtendedPointArray for an existing cell</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L61-L63">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.rebuild!-Tuple{NeighbourList, Cell}" href="#CellBase.rebuild!-Tuple{NeighbourList, Cell}"><code>CellBase.rebuild!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rebuild(nl::NeighbourList, cell::Cell)</code></pre><p>Perform a full rebuild of the NeighbourList with the latest geometry of the cell</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L241-L245">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.rebuild!-Tuple{NeighbourList, ExtendedPointArray}" href="#CellBase.rebuild!-Tuple{NeighbourList, ExtendedPointArray}"><code>CellBase.rebuild!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rebuild!(nl::NeighbourList, ea::ExtendedPointArray)</code></pre><p>Perform a full rebuild of the neighbour list from scratch</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L191-L195">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.update!-Tuple{NeighbourList, Cell}" href="#CellBase.update!-Tuple{NeighbourList, Cell}"><code>CellBase.update!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update!(nl::NeighbourList, cell::Cell)</code></pre><p>Update the NeighbourList with the latest geometry of the Cell. No rebuilding is performed</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L272-L277">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.update!-Tuple{NeighbourList}" href="#CellBase.update!-Tuple{NeighbourList}"><code>CellBase.update!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Update the calculated distances/vectors but do not rebuild the whole neighbour list</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/neighbour.jl#L251-L253">source</a></section></article><h2 id="IO"><a class="docs-heading-anchor" href="#IO">IO</a><a id="IO-1"></a><a class="docs-heading-anchor-permalink" href="#IO" title="Permalink"></a></h2><p>Code for read/writing file of crystal structures.</p><article class="docstring"><header><a class="docstring-binding" id="CellBase.read_res-Tuple{Vector{String}}" href="#CellBase.read_res-Tuple{Vector{String}}"><code>CellBase.read_res</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read an array containing the lines of the SHELX file</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_res.jl#L6-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.write_res-Tuple{AbstractString, Cell}" href="#CellBase.write_res-Tuple{AbstractString, Cell}"><code>CellBase.write_res</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_res(fname::AbstractString, structure::Cell)</code></pre><p>Write out SHELX format data to a file</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_res.jl#L137-L141">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.write_res-Tuple{IO, Cell}" href="#CellBase.write_res-Tuple{IO, Cell}"><code>CellBase.write_res</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_res(io::IO, structure::Cell)</code></pre><p>Write out SHELX format data</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_res.jl#L84-L88">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.push_xyz!-Tuple{Any, Cell}" href="#CellBase.push_xyz!-Tuple{Any, Cell}"><code>CellBase.push_xyz!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>xyz lines for a single frame</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_xyz.jl#L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.write_xyz-Union{Tuple{T}, Tuple{Any, Array{Cell{T}, 1}}} where T" href="#CellBase.write_xyz-Union{Tuple{T}, Tuple{Any, Array{Cell{T}, 1}}} where T"><code>CellBase.write_xyz</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Write snapshots to a xyz file</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_xyz.jl#L7-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.CellIO._parse_tagline-Tuple{Any, Any}" href="#CellBase.CellIO._parse_tagline-Tuple{Any, Any}"><code>CellBase.CellIO._parse_tagline</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Parse the tag line, return a dictionary of the tagline is in the form of &lt;ion<em>set</em>name&gt; % KEY=VALUE KEY=VALUE</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_cell.jl#L131-L134">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.CellIO.clean_lines-Tuple{Any}" href="#CellBase.CellIO.clean_lines-Tuple{Any}"><code>CellBase.CellIO.clean_lines</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Clean lines by removing new line symbols and comments</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_cell.jl#L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.CellIO.filter_block-Tuple{Any}" href="#CellBase.CellIO.filter_block-Tuple{Any}"><code>CellBase.CellIO.filter_block</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Get rid of blocks </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_cell.jl#L241-L243">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.CellIO.filter_block-Union{Tuple{T}, Tuple{Any, Vector{T}}} where T&lt;:AbstractString" href="#CellBase.CellIO.filter_block-Union{Tuple{T}, Tuple{Any, Vector{T}}} where T&lt;:AbstractString"><code>CellBase.CellIO.filter_block</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Filter away block names contained in only</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_cell.jl#L260-L262">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.CellIO.find_block-Tuple{Any, Any}" href="#CellBase.CellIO.find_block-Tuple{Any, Any}"><code>CellBase.CellIO.find_block</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Find the block with given name, return a Vector of the lines Comments are skipped</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_cell.jl#L214-L217">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.CellIO.parse_taglines-Union{Tuple{Vector{T}}, Tuple{T}} where T&lt;:AbstractString" href="#CellBase.CellIO.parse_taglines-Union{Tuple{Vector{T}}, Tuple{T}} where T&lt;:AbstractString"><code>CellBase.CellIO.parse_taglines</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Parse tag lines, return a vector of dictionary containing parsed tags </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_cell.jl#L174-L176">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.CellIO.read_cell-Tuple{AbstractString}" href="#CellBase.CellIO.read_cell-Tuple{AbstractString}"><code>CellBase.CellIO.read_cell</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read a cell file</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_cell.jl#L6-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.CellIO.read_cell-Union{Tuple{Vector{T}}, Tuple{T}} where T&lt;:AbstractString" href="#CellBase.CellIO.read_cell-Union{Tuple{Vector{T}}, Tuple{T}} where T&lt;:AbstractString"><code>CellBase.CellIO.read_cell</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read content of a cell file</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_cell.jl#L80-L82">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.CellIO.read_cellmat-Tuple{Any}" href="#CellBase.CellIO.read_cellmat-Tuple{Any}"><code>CellBase.CellIO.read_cellmat</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read cell related sections</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_cell.jl#L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.CellIO.read_num_block-Union{Tuple{T}, Tuple{Vector{T}, Int64}} where T&lt;:AbstractString" href="#CellBase.CellIO.read_num_block-Union{Tuple{T}, Tuple{Vector{T}, Int64}} where T&lt;:AbstractString"><code>CellBase.CellIO.read_num_block</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read a numerical block in the form of a vector of String</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_cell.jl#L195-L197">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.CellIO.read_positions-Tuple{Any, Any}" href="#CellBase.CellIO.read_positions-Tuple{Any, Any}"><code>CellBase.CellIO.read_positions</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read positions related sections</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_cell.jl#L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.CellIO.read_seed-Tuple{AbstractString}" href="#CellBase.CellIO.read_seed-Tuple{AbstractString}"><code>CellBase.CellIO.read_seed</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read in cell </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_cell.jl#L93-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.CellIO.read_seed-Union{Tuple{Vector{T}}, Tuple{T}} where T&lt;:AbstractString" href="#CellBase.CellIO.read_seed-Union{Tuple{Vector{T}}, Tuple{T}} where T&lt;:AbstractString"><code>CellBase.CellIO.read_seed</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read seed with the label parsed. At this stage no explansions are done</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_cell.jl#L102-L104">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.DotCastep.SnapShot" href="#CellBase.DotCastep.SnapShot"><code>CellBase.DotCastep.SnapShot</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Representation of a snapshot</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_dotcastep.jl#L7-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.DotCastep._get_nions-Tuple{Any}" href="#CellBase.DotCastep._get_nions-Tuple{Any}"><code>CellBase.DotCastep._get_nions</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Get the number of ions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_dotcastep.jl#L82-L84">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.DotCastep._read_snapshot" href="#CellBase.DotCastep._read_snapshot"><code>CellBase.DotCastep._read_snapshot</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Read the initial structure and its energy/forces</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_dotcastep.jl#L97-L99">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.DotCastep.read_castep-Tuple{String}" href="#CellBase.DotCastep.read_castep-Tuple{String}"><code>CellBase.DotCastep.read_castep</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_castep(fname::String)</code></pre><p>Read a CASTEP file, return a Vector of the Snapshots</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_dotcastep.jl#L27-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.DotCastep.read_coord_table!" href="#CellBase.DotCastep.read_coord_table!"><code>CellBase.DotCastep.read_coord_table!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Read fractional coordinates (column vectors) from a table</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_dotcastep.jl#L165-L167">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.DotCastep.read_lattice-Tuple{Any}" href="#CellBase.DotCastep.read_lattice-Tuple{Any}"><code>CellBase.DotCastep.read_lattice</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read lattice vectors from the lines (column vectors)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_dotcastep.jl#L184-L186">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.DotCastep.skip_to_header-Tuple{Vector{String}, Int64, Int64}" href="#CellBase.DotCastep.skip_to_header-Tuple{Vector{String}, Int64, Int64}"><code>CellBase.DotCastep.skip_to_header</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Skip to the next header</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_dotcastep.jl#L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.SheapIO.SheapOptions" href="#CellBase.SheapIO.SheapOptions"><code>CellBase.SheapIO.SheapOptions</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Commandline options for SHEAP</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_sheap.jl#L9-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.SheapIO._SheapDefaultOptions" href="#CellBase.SheapIO._SheapDefaultOptions"><code>CellBase.SheapIO._SheapDefaultOptions</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Record the default options of SHEAP commandline</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_sheap.jl#L38-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.SheapIO.parse_sheap_output-Tuple{IO}" href="#CellBase.SheapIO.parse_sheap_output-Tuple{IO}"><code>CellBase.SheapIO.parse_sheap_output</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Prase the output of SHEAP from an IO object</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_sheap.jl#L171-L173">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CellBase.SheapIO.run_sheap-Tuple{Any, CellBase.SheapIO.SheapOptions}" href="#CellBase.SheapIO.run_sheap-Tuple{Any, CellBase.SheapIO.SheapOptions}"><code>CellBase.SheapIO.run_sheap</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">run_sheap(vecs, opt::SheapOptions;metadata=repeat([SheapMetadata()], length(vecs)), show_stderr=true)</code></pre><p>Run SHEAP for a iterator of vectors with the given options.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zhubonan/CellBase/blob/f31d8bc9a0bb2d0d809fb8f6c90de9c021bb5570/src/io/io_sheap.jl#L150-L154">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 14 September 2022 16:17">Wednesday 14 September 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
